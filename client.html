<!DOCTYPE html>
<html>
    <head>
        <script src="/socket.io/socket.io.js"></script>
        <script type="text/javascript">

          var socketio = io.connect(location.href);

          socketio.on("message_to_client", function(data) {
            var chatlog = document.getElementById("chatlog");
            var message = data.username + ' ('+ data.sentOn + '): ' + data.message;
            chatlog.innerHTML = chatlog.innerHTML + "<br/>" + message;
          });

          function sendMessage(event) {
            if (!event || event.keyCode ===  13) {
              var msgElem = document.getElementById("message_input");
              var username = document.getElementById("username").value;
              socketio.emit("message_to_server", { 
                message : msgElem.value, 
                sentOn: new Date(),
                username: username 
              });
              msgElem.value = '';
            }
          }

        </script>
    </head>
    <body>
        <label>Username:</label>
        <input type="text" id="username"/>
        <label>Message:</label>
        <input autocomplete="off" onkeypress="sendMessage(event)" type="text" id="message_input"/>
        <button onclick="sendMessage()">send</button>
        <div id="chatlog"></div>
    </body>
</html>